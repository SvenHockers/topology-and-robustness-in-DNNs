seed: 0
exp_name: smoke_test
device: auto
output_dir: outputs/robustness/smoke

data:
  n_samples_per_shape: 15
  n_points: 10
  noise: 0.05
  val_split: 0.2
  batch_size: 8

model:
  arch: MLP
  train: true
  epochs: 3
  lr: 1e-3
  checkpoint: null

probes:
  adversarial:
    enabled: true
    norms: [linf]
    eps_max: 0.5
    steps: 10
    tol: 5e-3
    outer_bisect: true
    eps_grid: [0.0, 0.1, 0.2, 0.5]

  geometric:
    enabled: true
    tol: 5e-3
    rotation:
      axes: [z]
      deg_range: [-20, 20]
    translation:
      axes: [x]
      range: [-0.1, 0.1]
    jitter:
      std_range: [0.0, 0.1]
      clip: 0.3
    dropout:
      ratio_range: [0.0, 0.3]

  interpolation:
    enabled: true
    pairs_per_class: 5
    match: index
    steps: 15
    cross_class: false

  topology:
    enabled: true
    compute_dgm: true
    maxdim: 1
    sample_size: 100

  layerwise_topology:
    enabled: true
    layers: [input, fc1, fc2, fc3, pooled]
    distances: [wasserstein]
    maxdim: 1
    sample_size: 100
    conditions:
      adv_linf_eps: [0.1]
      rotation_deg: [10]
      jitter_std: [0.05]

reporting:
  save_csv: true
  save_plots: true
  save_artifacts: false
  sample_visualizations_per_class: 1


